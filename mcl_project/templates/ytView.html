<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auction Display</title>

  <style>
    body {
      margin: 0;
      background: transparent;
      font-family: Arial, sans-serif;
    }

    /* MAIN FRAME */
    .screen {
      width: 100%;
      height: 100vh;
      border: 4px solid black;
      position: relative;
    }

    /* COMMON BOX STYLE */
    .box {
      background: rgba(30, 60, 255, 0.6);
      color: #fff;
      border: 2px solid #000;
      padding: 10px 14px;
      font-weight: bold;
    }

    /* INFO BLOCK */
    .info-area {
      position: absolute;
      bottom: 90px;
      left: 80px;
      display: flex;
      align-items: flex-end;
      gap: 20px;
    }

    /* PHOTO */
    .photo-box {
      width: 130px;
      height: 160px;
      border: 2px solid black;
      background: rgba(30, 60, 255, 0.6);
    }

    .photo-box img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* TEXT STACK */
    .details {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .name-box { width: 260px; }
    .dept-box { width: 320px; }
    .role-box { width: 300px; }

    /* PRICE (RIGHT SIDE) */
    .price-box {
      position: absolute;
      right: 80px;
      bottom: 130px;
      width: 280px;
      text-align: center;
    }
  </style>
</head>

<body>

<div class="screen">

  <!-- LEFT INFO -->
  <div class="info-area">
    <div class="photo-box">
      <img id="playerPhoto">
    </div>

    <div class="details">
      <div class="box name-box" id="playerName"></div>
      <div class="box dept-box" id="playerDept"></div>
      <div class="box role-box" id="playerRole"></div>
    </div>
  </div>

  <!-- RIGHT PRICE -->
  <div class="box price-box" id="currentPrice"></div>
</div>

<script>
    const playerPhoto = document.getElementById('playerPhoto');
    const playerName = document.getElementById('playerName');
    const playerDept = document.getElementById('playerDept');
    const playerRole = document.getElementById('playerRole');
    const currentPrice = document.getElementById('currentPrice');

    const protocol = window.location.protocol === "https:" ? "wss" : "ws";
    const myYtSocket = new WebSocket(
      `${protocol}://${window.location.host}/ws/ac/`
    );

    myYtSocket.onmessage = function (event) {
      const data = JSON.parse(event.data);

      playerPhoto.src = data.photo_url;
      playerName.innerText = "Name : " + data.name;
      playerDept.innerText = "Dept : " + data.dept + " | Batch : " + data.batch;
      playerRole.innerText = "Role : " + data.role;
      currentPrice.innerText = "Current Price : " + data.current_bid + " By : " + data.team_name;
    };
    
    document.addEventListener("DOMContentLoaded", () => {
      fetch("/api/last-transaction-player/")
        .then(r => r.json())
        .then(data => {
        playerPhoto.src = data.photo_url;
        playerName.innerText = "Name : " + data.name;
        playerDept.innerText = "Dept : " + data.dept + " | Batch : " + data.batch;
        playerRole.innerText = "Role : " + data.role;
        currentPrice.innerText = "Current Price : " + data.bid_price + " By : " + data.team_name;
      });
    });

    
</script>

</body>
</html>
