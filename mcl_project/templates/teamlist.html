{% extends "base.html" %}
{% load static %}

{% block titleLink %}
<title>MCL-Teamlist</title>

<style>
  /* ===== CORE BOX ===== */
  .custom-box {
    background-color: var(--secondary-bg);
    border: 2px solid var(--border-color);
    padding: 15px;
    border-radius: 8px;
    text-align: center;
  }

  .header-title {
    color: var(--accent-color);
    font-weight: bold;
  }

  /* ===== TEAM LOGO ===== */
  .team-logo-circle {
    width: 70px;
    height: 70px;
    border: 2px solid var(--border-color);
    border-radius: 50%;
    object-fit: cover;
    background-color: var(--primary-bg);
  }

  /* ===== TABLE ===== */
  .table-custom {
    --bs-table-bg: var(--secondary-bg);
    --bs-table-color: var(--text-color);
  }

  .table-custom th,
  .table-custom td {
    padding: 12px;
    text-align: center;
    vertical-align: middle;
  }

  .table-responsive {
    border: 1px solid var(--border-color);
    border-radius: 8px;
    overflow: hidden;
  }

  /* ===== HEADER ===== */
  .team-header {
    background-color: var(--secondary-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 15px;
  }

  /* ===== POINTS + LOGO ===== */
  .points-logo-wrapper {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 15px;
  }

  /* ===== BUTTON ===== */
  .btn-control {
    width: 100%;
    padding: 15px;
    font-size: 1.1rem;
    font-weight: bold;
    border-radius: 8px;
  }

  .btn-logout-admin {
    background-color: var(--primary-bg);
    color: var(--danger-text);
    border: 2px solid var(--danger-text);
  }

  .btn-logout-admin:hover {
    background-color: var(--danger-text);
    color: var(--primary-bg);
  }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 768px) {
    .points-logo-wrapper {
      flex-direction: column;
    }

    .team-logo-circle {
      width: 60px;
      height: 60px;
    }
  }
</style>
{% endblock titleLink %}

{% block main %}
<main class="container-fluid px-3 px-md-4 py-3">

  <!-- HEADER -->
  <div class="row team-header align-items-center mb-4">
    <div class="col-md-8">
      <div class="points-logo-wrapper">
        <div class="custom-box">
          <b>Team Name</b> {{ team.TeamName }}
        </div>
        <div class="custom-box">
          <b>Remaining Price</b>
          <span class="text-warning">{{ price_re }}</span>
        </div>
        <div class="custom-box">
          <b>Total Player</b>
          <span class="text-success">{{ players.count }}</span>
        </div>
        <img src="{{ team.TeamLogo.url }}" class="team-logo-circle" alt="Team Logo">
      </div>
    </div>
  </div>

  <!-- PLAYER LIST -->
  <div class="row">
      <h5 class="header-title mb-3">Player Details</h5>
      <div class="table-responsive">
        <table class="table table-custom">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Role</th>
              <th>Price</th>
            </tr>
          </thead>
          <tbody>
            {% for player in players %}
            <tr>
              <td>{{ player.playername.P_ID }}</td>
              <td>{{ player.playername.Name }}</td>
              <td>{{ player.playername.PlayerRole }}</td>
              <td>{{ player.price }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
  </div>
  
  <!-- SUMMARY TABLE -->
  <div class="mb-4">
    <h5 class="header-title mb-3">Teams Current Price</h5>
    <table class="table table-custom">
      {% for team_row, price_row in team_chunks %}
        <thead>
          <tr>
            {% for team in team_row %}
              <th>{{ team.TeamName }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          <tr>
            {% for price in price_row %}
              {% if price < price_re %}
                <td class="text-success">{{ price }}</td>
              {% elif price > price_re %}
                <td class="text-danger">{{ price }}</td>
              {% else %}
                <td class="text-warning">{{ price }}</td>
              {% endif %}
            {% endfor %}
          </tr>
        </tbody>
      {% endfor %}
    </table>
  </div>


  <!-- LOGOUT -->
  <div class="text-center mt-4">
    <button class="btn btn-control btn-logout-admin"
      onclick="document.getElementById('logout-form').submit()">
      Log Out
    </button>
  </div>

  <form id="logout-form" method="post" action="{% url 'logout' %}" style="display:none;">
    {% csrf_token %}
  </form>

</main>
{% endblock main %}
